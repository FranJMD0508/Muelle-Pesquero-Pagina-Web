<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras</title>
    <link rel="stylesheet" href="productstyle.css">
    <script src="compras.js"></script>
</head>
<body>
    <header>
        <h1>Carrito de Compras</h1>
    </header>
    <main>
        <section class="carrito">
            <h2>Productos en el Carrito</h2>
            <ul id="lista-carrito">
                <!-- Aquí se mostrarán los productos añadidos -->
            </ul>
            <h2>Datos desde la API</h2>
            <table id="alimentos">
                <thead>
                    <tr>
                        <th>Código</th>
                        <th>Producto</th>
                        <th>Cantidad</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Aquí se llenarán los datos de la API -->
                </tbody>
            </table>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 Menú de Ventas de Muelle Pesquero</p>
        <button id="back-button" class="back-button">VOLVER AL MENU PRINCIPAL</button>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const carrito = obtenerCarrito();
            const listaCarrito = document.getElementById('lista-carrito');

            carrito.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.producto}: ${item.cantidad}kg`;
                listaCarrito.appendChild(li);
            });

            const backButton = document.getElementById('back-button');
            backButton.addEventListener('click', () => {
                window.location.href = 'estructura.html';
            });

            fetch("https://e6a3-190-120-250-84.ngrok-free.app/", {
                method: "GET",
                headers: new Headers({
                    "ngrok-skip-browser-warning": "69420",
                }),
            })
            .then(response => response.json())
            .then(data => {
                const productosTable = document.querySelector('#alimentos tbody');
                if (data && data.data && Array.isArray(data.data)) {
                    data.data.forEach(producto => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${producto.codigo_pescado}</td>
                            <td>${producto.pescado}</td>
                            <td>${producto.cantidad_pescado} kg</td>
                        `;
                        productosTable.appendChild(row);
                    });
                } else {
                    console.error('Datos de productos no válidos:', data);
                }
            })
            .catch(error => console.error('Error al obtener los productos:', error));
        });
    </script>
</body>
</html>

